"0","chosen_four <- list.files(here::here(""risk_maps"","
"0","                                     ""data"", "
"0","                                     ""raw_data"", "
"0","                                     ""ECOSTRESS"", "
"0","                                     ""chosen_four""))"
"0",""
"0","regression <- readRDS(file = here(""risk_maps"", ""data"", ""raw_data"", ""regression.RDS""))"
"0",""
"0","STANDARD_ERROR <- summary(regression)$sigma"
"0",""
"0","four_panel <- function(risk_function, limits){"
"0","  date <- ymd(substr(chosen_four, 14, 23))"
"0","  hhmmss <- str_extract(chosen_four, regex('[0-9]{2}:{1}[0-9]{2}:{1}[0-9]{2}'))"
"0","  dt <- ymd_hms(paste(date, hhmmss), tz = ""America/Los_Angeles"")"
"0","  "
"0","  night <- raster(here::here(""risk_maps"","
"0","                                     ""data"", "
"0","                                     ""processed_data"", "
"0","                                     ""ECOSTRESS"", "
"0","                                     ""air_temperature"", "
"0","                                     chosen_four[1]))"
"0","  dawn <- raster(here::here(""risk_maps"","
"0","                                     ""data"", "
"0","                                     ""processed_data"", "
"0","                                     ""ECOSTRESS"", "
"0","                                     ""air_temperature"", "
"0","                                     chosen_four[2]))"
"0","  day <- raster(here::here(""risk_maps"","
"0","                                     ""data"", "
"0","                                     ""processed_data"", "
"0","                                     ""ECOSTRESS"", "
"0","                                     ""air_temperature"", "
"0","                                     chosen_four[3]))"
"0","  dusk <- raster(here::here(""risk_maps"","
"0","                                     ""data"", "
"0","                                     ""processed_data"", "
"0","                                     ""ECOSTRESS"", "
"0","                                     ""air_temperature"", "
"0","                                     chosen_four[4]))"
"0","  "
"0","  get_error <- function(temp_raster){"
"0",""
"0","    max_error_by_pixel <- function(temperature){"
"0",""
"0","      lower_bound <- temperature - STANDARD_ERROR*1.96"
"0","      upper_bound <- temperature + STANDARD_ERROR*1.96"
"0",""
"0","      max <- optimize(risk_function, interval=c(lower_bound, upper_bound), maximum=TRUE)$objective"
"0","      min <- optimize(risk_function, interval=c(lower_bound, upper_bound), maximum=FALSE)$objective"
"0",""
"0","      return(max - min)"
"0","    }"
"0",""
"0","    values <- raster::values(temp_raster)"
"0","    errors <- sapply(values, max_error_by_pixel)"
"0","    values(temp_raster) <- errors"
"0","    return(temp_raster)"
"0","  }"
"0","  "
"0","  dawn <- get_error(dawn)"
"0","  day <- get_error(day)"
"0","  dusk <- get_error(dusk)"
"0","  night <- get_error(night)"
"0","  "
"0","  pal <- colorRampPalette(c(""darkblue"", ""blue"", ""steelblue1"", ""white"", ""yellow"", ""orange"", ""red""))"
"0","  "
"0","  plot(dawn, "
"0","       col = pal(50), "
"0","       zlim=limits,"
"0","       xlab=""Longitude"", "
"0","       ylab = ""Latitude"")"
"0","  title(paste0(""Dawn ("", dt[2],"")""))"
"0","  "
"0","  plot(day, "
"0","       col = pal(50), "
"0","       zlim=limits,"
"0","       xlab=""Longitude"", "
"0","       ylab = ""Latitude"")"
"0","  title(paste0(""Day ("", dt[3],"")""))"
"0","  "
"0","  plot(dusk, "
"0","       col = pal(50), "
"0","       zlim=limits,"
"0","       xlab=""Longitude"", "
"0","       ylab = ""Latitude"")"
"0","  title(paste0(""Dusk ("", dt[4],"")""))"
"0","  "
"0","  plot(night, "
"0","       col = pal(50), "
"0","       zlim=limits,"
"0","       xlab=""Longitude"", "
"0","       ylab = ""Latitude"")"
"0","  title(paste0(""Night ("", dt[1],"")""))"
"0","}"
